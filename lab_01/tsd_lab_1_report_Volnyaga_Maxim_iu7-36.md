# Лабораторная работа №1
## Вольняга Максим, студент ИУ7-36Б

### Описание условия
Необходимо реализовать арифметические операции над числами, выходящими за разрядную сетку ПК, выбрав и разработав необходимые типы данных для хранения и обработки данных чисел. Требуется смоделировать операцию умножения действительного числа на простое число, где порядок имеет до 5 разрядов (от -99999 до 99999), а мантисса - до 30 знаков.

### Описание ТЗ
#### Описание исходных данных и результатов:
(типы, форматы, точность, способ передачи, ограничения)
Программа получает на вход два значения.

Первое значение является действительным числом. Оно вводится в формате +/-m.n E +/-K, где суммарная длина мантиссы m+k <= 30, а величина порядка K - не больше 5 цифр (т.е. порядок принимает значения от -99999 до +99999)

Второе значение является целым числом, оно может содержать не более 30 десятичных цифр и (опционально) знак '+'/'-'.

Результат выводится в формате +/-0.m E +/-K, где m - мантисса не более 30 значащих цифр, а K - порядок до 5 цифр

#### Описание задачи, реализуемой программой
Программа производит операцию умножения первого введённого (действительного) числа на второе (целое) и выводит результат в нормализованной форме, либо сообщает о невозможности произвести счёт.

#### Способ обращения к программе
Обращение к программе происходит путём консольного ввода чисел пользователем в заданном формате.

#### Описание возможных аварийных ситуаций и ошибок пользователя
Аварийные ситуации:
1. Результат умножения не попадает под ограничения выводимого формата (происходит в случае, если абсолютное значение порядка превышает 99999)
2. Ввод одного из параметров в некорректном формате (для первого, не указан знак числа и знак мантиссы. Величина порядка больше 5 чисел.
3. (для второго параметра - попытка ввода вещественного числа, а также лишние символы в числе или число имеет более 30 цифр)
4. Суммарная длина мантиссы больше 30 символов
5. Ввод некорректных данных (не распознаваемые символы в потоке ввода)


### Описание внутренних СД
Основной тип, используемый в программе - полиморфный тип числа длинной арифметики.

```c
#define MAX_MANTISSA 31

typedef struct number
{
    char mantissa_sign; // знак мантиссы
    char mantissa[MAX_MANTISSA * 2]; // сама мантисса
    int degree; // степень
    int point_ind; // индекса нахождения точки
} number_t;
```

### Описание алгоритма

Основные алгоритмы в программе - ввод числа и деление.

Ввод числа осуществляется путём считывание строки и дальнейшего его анализа. Анализ числа происходит при помощи парсинга строк, где число разбивается на состовляющие (знак, мантисса, степень и индекс точки для действительного числа) 

### Умножение происходит с использованием алгоритма умножение в столбик.

Перемножение мантисс происходит по следующему принципу:  
```
Введем обозначения для простоты:

ЦЕЛ_МАНТИС - символьный массив содержащий мантиссу целого числа
ДЛИНА1 - длина (ЦЕЛ_МАНТИС)
ДЕЙСТВ_МАНТИС - символьный массив содержащий мантиссу действительного числа
ДЛИНА2 - длина (ДЕЙСТВ_МАНТИС)
ТЕМП_МАСС - символьный массив содержащий число, которое было получено умножением одного разряда(ЦЕЛ_МАНТИС) на мантиссу (ДЕЙСТВ_МАНТИС)
ТЕМП_ДЛИНА - длина (ТЕМП_МАСС)
РЕС_МАНТИС - символьный массив содержащий результат перемножения мантисс 
ТЕМП_УМНОЖ - временное целое число для хранения умножения разрядов максимум 81
ТЕМП_ПЛЮС - временная переменная целая для хранения 
ИТЕР = 1 обозначает итерацию
Н = 60 возможное обозначает кол-во элементов

Знак "=" обозначает присваивание
Знак "*" обозначает мат. умножение 
Знак "-" обозначает мат. минус
Знак "+" обозначает мат. плюс 
Знак "%" обозначаем остаток от деления 
Знак "/" обозначаем целочисленное деление

ЦЕЛ_МАНТИС [длина] - означает последний элемент массива
ОЧИСТИТЬ - заполнить всё нулевыми элементами
```
```
Пока ДЛИНА1 (не равна -1) делать:
    ЦЕЛ_ЧИСЛО = ЦЕЛ_МАНТИС[ДЛИНА1]
    ТЕМП_ДЛИНА = 60 - ИТЕР
    ОЧИСТИТЬ ЦЕЛ_МАНТИС

    # Цикл для перемножения целого числа с мантиссой
    Пока ДЛИНА2 (не равна нулю делать) делать:
        ДЛИНА2 = ДЛИНА2 - 1
        ТЕМП_УМНОЖ = ДЕЙСТВ_МАНТИС[ДЛИНА2] * ЦЕЛ_ЧИСЛО
        ТЕМП_МАСС[ТЕМП_ДЛИНА] = ТЕМП_МАСС[ТЕМП_ДЛИНА] + ТЕМП_УМНОЖ % 10 (последнее Цифра числа)
        ТЕМП_МАСС[ТЕМП_ДЛИНА - 1] =  ТЕМП_МАСС[ТЕМП_ДЛИНА - 1] + ТЕМП_УМНОЖ / 10 (первая Цифра числа)
        ТЕМП_ДЛИНА = ТЕМП_ДЛИНА - 1
    все пока

    Н = 60
    # Цикл для сложения числа полученного в пред. циле с результатом
    Пока (Н не равно 1) делать:
        ТЕМП_ПЛЮС = ТЕМП_МАСС[H] + РЕС_МАНТИС[H] 
        РЕС_МАНТИС[H] = ТЕМП_ПЛЮС % 10 (последнее Цифра числа)
        РЕС_МАНТИС[H - 1] = РЕС_МАНТИС[H - 1] + ТЕМП_ПЛЮС /   10   (первая Цифра числа)
        Н = Н - 1
    Все пока

    ДЛИНА1 = ДЛИНА1 - 1
    ИТЕР = ИТЕР + 1
```


### Набор тестов с указанием проверямого параметра

| Ввод | Вывод | Что проверяется |
| - | - | - |
| +0.01 и 1 | +0.1E-1 | обычное умножение на единицу |
| -0.01 и 1 | -0.1E-1 | действительное число со знаком минус целое полож проверка знака |
| +0.01 и -1 | -0.1E-1 | действительное число со знаком плюс целое отрицательное проверка знака |
| -0.01 и -1 | +0.1E-1 | обработка знака если два числа отрицательны |
| +999999999999999999999999999999E+9999 и +999999999999999999999999999999 | +0.999999999999999999999999999998E+10059 | умножение максимального  целого на большое действительное  |
| +999999999999999999999999999999E+99999 и 1 | +0.99999999999999999999999999999E+99999 | умножение максимального  действительного на единицу |
|-999999999999999999999999999999E-99999 и 1 | -0.99999999999999999999999999999E-99999 | умножение минимального действительного на единицу |
| +0.0E+5655 и 1 | 0.0 | умножение  ноль на единицу |
| +0.1E+5655 и 0 | 0.0 | умножение  ноль на действ |
| +0.0E+5655 и 0 | 0.0 | умножение  ноль на ноль |
| +333333333333333333333333333333E+999 и 9 | +0.3E+1030 | проверка округления числа |
| +0.01E-99999 10 |  +0.1E-99999 | обычный тест с проверкой на степень |
| НЕГАТИВНЫЕ | ТЕСТЫ | - |
| -  -   | Ошибка: действительное число введено некорректно! | Пустой ввод |
| -  6   | Ошибка: действительное число введено некорректно! | первое число пустое |
| +1.0 - | Ошибка: целое число введено некоректно! | второе число пустое |
| 1.0  1 | Ошибка: не указан знак мантиссы! | обработка знака мантиссы не указан |
| +1E1 1 | Ошибка: не указан знак степени! | обработка знака степени не указан |
| 9...9 (31) 1 | Ошибка: мантисса должна содержать менее 30 цифр! |обработка длинны мантиссы |
| +0.0 9...9 (31)  | Ошибка: целое число должно содержать менее 30 цифр! |обработка длинны целого числа |
| +0.1E+999999 1  | Ошибка: степень должна состоять из 5 или менее символов! | обработка длины степени |
| +7у4Е+5 1  | Ошибка: дейтсвительное число введено в некорректной форме! | обработка правильности ввода действительного числа |
| +1455 4в5  | Ошибка: целое число введено в некорректной форме! | обработка правильности ввода целого числа |
| +1455+E+66 1   | Ошибка: дейтсвительное число введено в некорректной форме! | обработка двух плюсов в мантиссе |
| +1455E+6+6 1   | Ошибка: дейтсвительное число введено в некорректной форме! | обработка двух плюсов в степени |
| +14.55.E+66 1   | Ошибка: дейтсвительное число введено в некорректной форме! | обработка двух точек в мантисе |
| +14.55E+6.6 1   | Ошибка: дейтсвительное число введено в некорректной форме! | обработка двух точек в степени |
| +14.55E+66 1.5  | Ошибка: целое число введено в некорректной форме! | обработка  точек в целом |
| +14.55E+66 +1+5  | Ошибка: целое число введено в некорректной форме! | обработка двух знаков в целом |

### Выводы

Если  необходимо проводить арифметические операции над числами повышенной точности или размера необходимо использовать длинную арифметику.

Длинная арифметику можно  смоделировать путём представления чисел в виде массива цифр и степени, это   позволит нам легко реализовать различные операции, например,  сложение, вычитание, сравнение.

Для операций над длинной арифметикой можно использовать классические математические алгоритмы, например, алгоритм умножения числа в столбик

### Ответы на вопросы

##### 1. Каков возможный диапазон чисел, представляемых в ПК?

Целые числа (со знаком):

| Выделенные разряды | Диапазон |
| --- | --- |
| 16 | -32768...32767 |
| 32 | -2 147 483 648...2 147 483 647 |
| 64 | -9 223 372 036 854 775 808...9 223 372 036 854 775 807 |

Целые числа (беззнаковые):

| Выделенные разряды | Диапазон |
| --- | --- |
| 16 | 0...65 535 |
| 32 | 0...4 294 967 295 |
| 64 | 0...18 446 744 073 709 551 616 |

Вещественные числа:

| Выделенные разряды | Диапазон |
| --- | --- |
| 32 (single precision) | 3.4E-38...3.4E+38 |
| 64 (double precision) | 1.7E-308...1.7E+308 |
| 80 (extended precision) | 3.4E-4932...3.4E+4932 |

Беззнаковое число 0 <= X <= 2^N – 1. Знаковое число 2^N <= X <= 2^N – 1, где N – количество бит выделенных под число.

##### 2. Какова возможная точность представления чисел, чем она определяется?
Длина мантиссы определяет точность представления числа, а длина порядка ограничивает диапазон допустимых значений. При этом, если мантисса выходит за разрядную сетку ПК, то происходит ее округление.

##### 3. Какие стандартные операции возможны над числами?

Над числами возможны арифметические и логические операции
Логические:
Сравнение, для целых: исключающее ИЛИ, логическое И, ИЛИ, побитовое отрицание

Арифметические:
Сложение, вычитание, унарный плюс и минус, инкремент и декремент, умножение и деление, для целых - деление по модулю

##### 4. Какой тип данных может выбрать программист, если обрабатываемые числа превышают возможный диапазон представления чисел в ПК?

Для обработки превышающих чисел возможный диапазон представления используется массив цифр, так же можно создать структуру данных где будет хранится мантисса числа, знак мантиссы, степень, знак степени 

##### 5. Как можно осуществить операции над числами, выходящими за рамки машинного представления?

 Операции над числами, которые выходят за рамки машинного представления можно осуществлять при помощи алгортимов сложения, вычитания, умножения и деления в столбик